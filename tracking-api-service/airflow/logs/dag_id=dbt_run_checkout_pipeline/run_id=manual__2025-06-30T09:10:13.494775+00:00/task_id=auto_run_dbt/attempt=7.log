[2025-06-30T10:23:54.012+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-06-30T10:23:54.030+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: dbt_run_checkout_pipeline.auto_run_dbt manual__2025-06-30T09:10:13.494775+00:00 [queued]>
[2025-06-30T10:23:54.137+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: dbt_run_checkout_pipeline.auto_run_dbt manual__2025-06-30T09:10:13.494775+00:00 [queued]>
[2025-06-30T10:23:54.137+0000] {taskinstance.py:2303} INFO - Starting attempt 7 of 9
[2025-06-30T10:23:54.152+0000] {taskinstance.py:2327} INFO - Executing <Task(BashOperator): auto_run_dbt> on 2025-06-30 09:10:13.494775+00:00
[2025-06-30T10:23:54.156+0000] {standard_task_runner.py:63} INFO - Started process 1122 to run task
[2025-06-30T10:23:54.160+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'dbt_run_checkout_pipeline', 'auto_run_dbt', 'manual__2025-06-30T09:10:13.494775+00:00', '--job-id', '54', '--raw', '--subdir', 'DAGS_FOLDER/automatic_run_dbt.py', '--cfg-path', '/tmp/tmp64zye71j']
[2025-06-30T10:23:54.162+0000] {standard_task_runner.py:91} INFO - Job 54: Subtask auto_run_dbt
[2025-06-30T10:23:54.173+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.11/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-06-30T10:23:54.196+0000] {task_command.py:426} INFO - Running <TaskInstance: dbt_run_checkout_pipeline.auto_run_dbt manual__2025-06-30T09:10:13.494775+00:00 [running]> on host c0587897547b
[2025-06-30T10:23:54.250+0000] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='hosi04' AIRFLOW_CTX_DAG_ID='dbt_run_checkout_pipeline' AIRFLOW_CTX_TASK_ID='auto_run_dbt' AIRFLOW_CTX_EXECUTION_DATE='2025-06-30T09:10:13.494775+00:00' AIRFLOW_CTX_TRY_NUMBER='7' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-06-30T09:10:13.494775+00:00'
[2025-06-30T10:23:54.250+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-06-30T10:23:54.258+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-06-30T10:23:54.258+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /opt/***/dbt && dbt run --profiles-dir /opt/***/.dbt/']
[2025-06-30T10:23:54.268+0000] {subprocess.py:86} INFO - Output:
[2025-06-30T10:23:55.620+0000] {subprocess.py:93} INFO - [0m10:23:55  Running with dbt=1.10.2
[2025-06-30T10:23:55.775+0000] {subprocess.py:93} INFO - [0m10:23:55  Registered adapter: clickhouse=1.9.2
[2025-06-30T10:23:56.279+0000] {subprocess.py:93} INFO - [0m10:23:56  Found 4 models, 2 sources, 476 macros
[2025-06-30T10:23:56.281+0000] {subprocess.py:93} INFO - [0m10:23:56
[2025-06-30T10:23:56.281+0000] {subprocess.py:93} INFO - [0m10:23:56  Concurrency: 1 threads (target='dev')
[2025-06-30T10:23:56.281+0000] {subprocess.py:93} INFO - [0m10:23:56
[2025-06-30T10:23:56.619+0000] {subprocess.py:93} INFO - WARNING:urllib3.connectionpool:Retrying (Retry(total=0, connect=None, read=None, redirect=0, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x76dc3f3c1490>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution')': /?
[2025-06-30T10:23:56.622+0000] {subprocess.py:93} INFO - WARNING:clickhouse_connect.driver.httpclient:Unexpected Http Driver Exception
[2025-06-30T10:23:57.628+0000] {subprocess.py:93} INFO - WARNING:urllib3.connectionpool:Retrying (Retry(total=0, connect=None, read=None, redirect=0, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x76dbf38866d0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution')': /?
[2025-06-30T10:23:57.630+0000] {subprocess.py:93} INFO - WARNING:clickhouse_connect.driver.httpclient:Unexpected Http Driver Exception
[2025-06-30T10:23:57.637+0000] {subprocess.py:93} INFO - WARNING:urllib3.connectionpool:Retrying (Retry(total=0, connect=None, read=None, redirect=0, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x76dbf38a2750>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution')': /?
[2025-06-30T10:23:57.639+0000] {subprocess.py:93} INFO - WARNING:clickhouse_connect.driver.httpclient:Unexpected Http Driver Exception
[2025-06-30T10:23:58.644+0000] {subprocess.py:93} INFO - WARNING:urllib3.connectionpool:Retrying (Retry(total=0, connect=None, read=None, redirect=0, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x76dbf38b0890>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution')': /?
[2025-06-30T10:23:58.646+0000] {subprocess.py:93} INFO - WARNING:clickhouse_connect.driver.httpclient:Unexpected Http Driver Exception
[2025-06-30T10:23:58.650+0000] {subprocess.py:93} INFO - WARNING:urllib3.connectionpool:Retrying (Retry(total=0, connect=None, read=None, redirect=0, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x76dbf38d1950>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution')': /?
[2025-06-30T10:23:58.651+0000] {subprocess.py:93} INFO - WARNING:clickhouse_connect.driver.httpclient:Unexpected Http Driver Exception
[2025-06-30T10:23:59.654+0000] {subprocess.py:93} INFO - WARNING:urllib3.connectionpool:Retrying (Retry(total=0, connect=None, read=None, redirect=0, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x76dbf38d3890>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution')': /?
[2025-06-30T10:23:59.655+0000] {subprocess.py:93} INFO - WARNING:clickhouse_connect.driver.httpclient:Unexpected Http Driver Exception
[2025-06-30T10:23:59.657+0000] {subprocess.py:93} INFO - [0m10:23:59
[2025-06-30T10:23:59.658+0000] {subprocess.py:93} INFO - [0m10:23:59  Finished running  in 0 hours 0 minutes and 3.38 seconds (3.38s).
[2025-06-30T10:23:59.658+0000] {subprocess.py:93} INFO - [0m10:23:59  Encountered an error:
[2025-06-30T10:23:59.658+0000] {subprocess.py:93} INFO - Database Error
[2025-06-30T10:23:59.658+0000] {subprocess.py:93} INFO -   Error HTTPConnectionPool(host='clickhouse', port=8123): Max retries exceeded with url: /? (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x76dbf38871d0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution')) executing HTTP request attempt 1 (http://clickhouse:8123)
[2025-06-30T10:24:00.962+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2025-06-30T10:24:00.963+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
[2025-06-30T10:24:00.963+0000] {subprocess.py:93} INFO -     conn = connection.create_connection(
[2025-06-30T10:24:00.963+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.963+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/urllib3/util/connection.py", line 72, in create_connection
[2025-06-30T10:24:00.963+0000] {subprocess.py:93} INFO -     for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
[2025-06-30T10:24:00.963+0000] {subprocess.py:93} INFO -                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.963+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.11/socket.py", line 962, in getaddrinfo
[2025-06-30T10:24:00.963+0000] {subprocess.py:93} INFO -     for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
[2025-06-30T10:24:00.964+0000] {subprocess.py:93} INFO -                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.964+0000] {subprocess.py:93} INFO - socket.gaierror: [Errno -3] Temporary failure in name resolution
[2025-06-30T10:24:00.964+0000] {subprocess.py:93} INFO - 
[2025-06-30T10:24:00.964+0000] {subprocess.py:93} INFO - During handling of the above exception, another exception occurred:
[2025-06-30T10:24:00.964+0000] {subprocess.py:93} INFO - 
[2025-06-30T10:24:00.964+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2025-06-30T10:24:00.964+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen
[2025-06-30T10:24:00.964+0000] {subprocess.py:93} INFO -     httplib_response = self._make_request(
[2025-06-30T10:24:00.964+0000] {subprocess.py:93} INFO -                        ^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.964+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request
[2025-06-30T10:24:00.964+0000] {subprocess.py:93} INFO -     conn.request(method, url, **httplib_request_kw)
[2025-06-30T10:24:00.964+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
[2025-06-30T10:24:00.964+0000] {subprocess.py:93} INFO -     super(HTTPConnection, self).request(method, url, body=body, headers=headers)
[2025-06-30T10:24:00.964+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.11/http/client.py", line 1303, in request
[2025-06-30T10:24:00.964+0000] {subprocess.py:93} INFO -     self._send_request(method, url, body, headers, encode_chunked)
[2025-06-30T10:24:00.965+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.11/http/client.py", line 1349, in _send_request
[2025-06-30T10:24:00.965+0000] {subprocess.py:93} INFO -     self.endheaders(body, encode_chunked=encode_chunked)
[2025-06-30T10:24:00.965+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.11/http/client.py", line 1298, in endheaders
[2025-06-30T10:24:00.965+0000] {subprocess.py:93} INFO -     self._send_output(message_body, encode_chunked=encode_chunked)
[2025-06-30T10:24:00.965+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.11/http/client.py", line 1058, in _send_output
[2025-06-30T10:24:00.965+0000] {subprocess.py:93} INFO -     self.send(msg)
[2025-06-30T10:24:00.965+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.11/http/client.py", line 996, in send
[2025-06-30T10:24:00.965+0000] {subprocess.py:93} INFO -     self.connect()
[2025-06-30T10:24:00.965+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
[2025-06-30T10:24:00.965+0000] {subprocess.py:93} INFO -     conn = self._new_conn()
[2025-06-30T10:24:00.966+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.966+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
[2025-06-30T10:24:00.966+0000] {subprocess.py:93} INFO -     raise NewConnectionError(
[2025-06-30T10:24:00.966+0000] {subprocess.py:93} INFO - urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x76dbf3a9d650>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution
[2025-06-30T10:24:00.966+0000] {subprocess.py:93} INFO - 
[2025-06-30T10:24:00.966+0000] {subprocess.py:93} INFO - During handling of the above exception, another exception occurred:
[2025-06-30T10:24:00.966+0000] {subprocess.py:93} INFO - 
[2025-06-30T10:24:00.966+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2025-06-30T10:24:00.966+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/clickhouse_connect/driver/httpclient.py", line 456, in _raw_request
[2025-06-30T10:24:00.966+0000] {subprocess.py:93} INFO -     response = self.http.request(method, url, **kwargs)
[2025-06-30T10:24:00.966+0000] {subprocess.py:93} INFO -                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.966+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/urllib3/request.py", line 81, in request
[2025-06-30T10:24:00.967+0000] {subprocess.py:93} INFO -     return self.request_encode_body(
[2025-06-30T10:24:00.967+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.967+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/urllib3/request.py", line 173, in request_encode_body
[2025-06-30T10:24:00.967+0000] {subprocess.py:93} INFO -     return self.urlopen(method, url, **extra_kw)
[2025-06-30T10:24:00.967+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.967+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/urllib3/poolmanager.py", line 376, in urlopen
[2025-06-30T10:24:00.967+0000] {subprocess.py:93} INFO -     response = conn.urlopen(method, u.request_uri, **kw)
[2025-06-30T10:24:00.967+0000] {subprocess.py:93} INFO -                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.967+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 827, in urlopen
[2025-06-30T10:24:00.967+0000] {subprocess.py:93} INFO -     return self.urlopen(
[2025-06-30T10:24:00.967+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^
[2025-06-30T10:24:00.967+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen
[2025-06-30T10:24:00.967+0000] {subprocess.py:93} INFO -     retries = retries.increment(
[2025-06-30T10:24:00.967+0000] {subprocess.py:93} INFO -               ^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.967+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
[2025-06-30T10:24:00.967+0000] {subprocess.py:93} INFO -     raise MaxRetryError(_pool, url, error or ResponseError(cause))
[2025-06-30T10:24:00.967+0000] {subprocess.py:93} INFO - urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='clickhouse', port=8123): Max retries exceeded with url: /? (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x76dbf3a9d650>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))
[2025-06-30T10:24:00.967+0000] {subprocess.py:93} INFO - 
[2025-06-30T10:24:00.968+0000] {subprocess.py:93} INFO - The above exception was the direct cause of the following exception:
[2025-06-30T10:24:00.968+0000] {subprocess.py:93} INFO - 
[2025-06-30T10:24:00.968+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2025-06-30T10:24:00.968+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/adapters/clickhouse/httpclient.py", line 58, in _create_client
[2025-06-30T10:24:00.968+0000] {subprocess.py:93} INFO -     return clickhouse_connect.get_client(
[2025-06-30T10:24:00.968+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.968+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/clickhouse_connect/driver/__init__.py", line 122, in create_client
[2025-06-30T10:24:00.968+0000] {subprocess.py:93} INFO -     return HttpClient(interface, host, port, username, password, database, access_token,
[2025-06-30T10:24:00.968+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.968+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/clickhouse_connect/driver/httpclient.py", line 165, in __init__
[2025-06-30T10:24:00.968+0000] {subprocess.py:93} INFO -     super().__init__(database=database,
[2025-06-30T10:24:00.968+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/clickhouse_connect/driver/client.py", line 70, in __init__
[2025-06-30T10:24:00.968+0000] {subprocess.py:93} INFO -     self._init_common_settings(apply_server_timezone)
[2025-06-30T10:24:00.968+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/clickhouse_connect/driver/client.py", line 75, in _init_common_settings
[2025-06-30T10:24:00.968+0000] {subprocess.py:93} INFO -     tuple(self.command('SELECT version(), timezone()', use_database=False))
[2025-06-30T10:24:00.968+0000] {subprocess.py:93} INFO -           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.968+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/clickhouse_connect/driver/httpclient.py", line 368, in command
[2025-06-30T10:24:00.968+0000] {subprocess.py:93} INFO -     response = self._raw_request(payload, params, headers, method, fields=fields, server_wait=False)
[2025-06-30T10:24:00.969+0000] {subprocess.py:93} INFO -                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.969+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/clickhouse_connect/driver/httpclient.py", line 468, in _raw_request
[2025-06-30T10:24:00.969+0000] {subprocess.py:93} INFO -     raise OperationalError(f'Error {ex} executing HTTP request attempt {attempts}{err_url}') from ex
[2025-06-30T10:24:00.969+0000] {subprocess.py:93} INFO - clickhouse_connect.driver.exceptions.OperationalError: Error HTTPConnectionPool(host='clickhouse', port=8123): Max retries exceeded with url: /? (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x76dbf3a9d650>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution')) executing HTTP request attempt 1 (http://clickhouse:8123)
[2025-06-30T10:24:00.969+0000] {subprocess.py:93} INFO - 
[2025-06-30T10:24:00.969+0000] {subprocess.py:93} INFO - The above exception was the direct cause of the following exception:
[2025-06-30T10:24:00.969+0000] {subprocess.py:93} INFO - 
[2025-06-30T10:24:00.969+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2025-06-30T10:24:00.969+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/adapters/base/connections.py", line 237, in retry_connection
[2025-06-30T10:24:00.969+0000] {subprocess.py:93} INFO -     connection.handle = connect()
[2025-06-30T10:24:00.969+0000] {subprocess.py:93} INFO -                         ^^^^^^^^^
[2025-06-30T10:24:00.969+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/adapters/clickhouse/connections.py", line 45, in connect
[2025-06-30T10:24:00.969+0000] {subprocess.py:93} INFO -     return get_db_client(credentials)
[2025-06-30T10:24:00.970+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.970+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/adapters/clickhouse/dbclient.py", line 66, in get_db_client
[2025-06-30T10:24:00.970+0000] {subprocess.py:93} INFO -     return ChHttpClient(credentials)
[2025-06-30T10:24:00.970+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.970+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/adapters/clickhouse/dbclient.py", line 88, in __init__
[2025-06-30T10:24:00.970+0000] {subprocess.py:93} INFO -     self._client = self._create_client(credentials)
[2025-06-30T10:24:00.970+0000] {subprocess.py:93} INFO -                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.970+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/adapters/clickhouse/httpclient.py", line 75, in _create_client
[2025-06-30T10:24:00.970+0000] {subprocess.py:93} INFO -     raise ChRetryableException(str(ex)) from ex
[2025-06-30T10:24:00.970+0000] {subprocess.py:93} INFO - dbt.adapters.clickhouse.dbclient.ChRetryableException: Error HTTPConnectionPool(host='clickhouse', port=8123): Max retries exceeded with url: /? (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x76dbf3a9d650>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution')) executing HTTP request attempt 1 (http://clickhouse:8123)
[2025-06-30T10:24:00.970+0000] {subprocess.py:93} INFO - 
[2025-06-30T10:24:00.970+0000] {subprocess.py:93} INFO - During handling of the above exception, another exception occurred:
[2025-06-30T10:24:00.970+0000] {subprocess.py:93} INFO - 
[2025-06-30T10:24:00.970+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2025-06-30T10:24:00.970+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
[2025-06-30T10:24:00.970+0000] {subprocess.py:93} INFO -     conn = connection.create_connection(
[2025-06-30T10:24:00.971+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.971+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/urllib3/util/connection.py", line 72, in create_connection
[2025-06-30T10:24:00.971+0000] {subprocess.py:93} INFO -     for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
[2025-06-30T10:24:00.971+0000] {subprocess.py:93} INFO -                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.971+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.11/socket.py", line 962, in getaddrinfo
[2025-06-30T10:24:00.971+0000] {subprocess.py:93} INFO -     for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
[2025-06-30T10:24:00.971+0000] {subprocess.py:93} INFO -                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.971+0000] {subprocess.py:93} INFO - socket.gaierror: [Errno -3] Temporary failure in name resolution
[2025-06-30T10:24:00.971+0000] {subprocess.py:93} INFO - 
[2025-06-30T10:24:00.971+0000] {subprocess.py:93} INFO - During handling of the above exception, another exception occurred:
[2025-06-30T10:24:00.971+0000] {subprocess.py:93} INFO - 
[2025-06-30T10:24:00.971+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2025-06-30T10:24:00.971+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen
[2025-06-30T10:24:00.971+0000] {subprocess.py:93} INFO -     httplib_response = self._make_request(
[2025-06-30T10:24:00.971+0000] {subprocess.py:93} INFO -                        ^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.971+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request
[2025-06-30T10:24:00.971+0000] {subprocess.py:93} INFO -     conn.request(method, url, **httplib_request_kw)
[2025-06-30T10:24:00.971+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
[2025-06-30T10:24:00.972+0000] {subprocess.py:93} INFO -     super(HTTPConnection, self).request(method, url, body=body, headers=headers)
[2025-06-30T10:24:00.972+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.11/http/client.py", line 1303, in request
[2025-06-30T10:24:00.972+0000] {subprocess.py:93} INFO -     self._send_request(method, url, body, headers, encode_chunked)
[2025-06-30T10:24:00.972+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.11/http/client.py", line 1349, in _send_request
[2025-06-30T10:24:00.972+0000] {subprocess.py:93} INFO -     self.endheaders(body, encode_chunked=encode_chunked)
[2025-06-30T10:24:00.972+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.11/http/client.py", line 1298, in endheaders
[2025-06-30T10:24:00.972+0000] {subprocess.py:93} INFO -     self._send_output(message_body, encode_chunked=encode_chunked)
[2025-06-30T10:24:00.972+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.11/http/client.py", line 1058, in _send_output
[2025-06-30T10:24:00.972+0000] {subprocess.py:93} INFO -     self.send(msg)
[2025-06-30T10:24:00.972+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.11/http/client.py", line 996, in send
[2025-06-30T10:24:00.972+0000] {subprocess.py:93} INFO -     self.connect()
[2025-06-30T10:24:00.972+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
[2025-06-30T10:24:00.972+0000] {subprocess.py:93} INFO -     conn = self._new_conn()
[2025-06-30T10:24:00.972+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.972+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
[2025-06-30T10:24:00.972+0000] {subprocess.py:93} INFO -     raise NewConnectionError(
[2025-06-30T10:24:00.972+0000] {subprocess.py:93} INFO - urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x76dbf38871d0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution
[2025-06-30T10:24:00.973+0000] {subprocess.py:93} INFO - 
[2025-06-30T10:24:00.973+0000] {subprocess.py:93} INFO - During handling of the above exception, another exception occurred:
[2025-06-30T10:24:00.973+0000] {subprocess.py:93} INFO - 
[2025-06-30T10:24:00.973+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2025-06-30T10:24:00.973+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/clickhouse_connect/driver/httpclient.py", line 456, in _raw_request
[2025-06-30T10:24:00.973+0000] {subprocess.py:93} INFO -     response = self.http.request(method, url, **kwargs)
[2025-06-30T10:24:00.973+0000] {subprocess.py:93} INFO -                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.973+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/urllib3/request.py", line 81, in request
[2025-06-30T10:24:00.973+0000] {subprocess.py:93} INFO -     return self.request_encode_body(
[2025-06-30T10:24:00.973+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.973+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/urllib3/request.py", line 173, in request_encode_body
[2025-06-30T10:24:00.973+0000] {subprocess.py:93} INFO -     return self.urlopen(method, url, **extra_kw)
[2025-06-30T10:24:00.973+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.973+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/urllib3/poolmanager.py", line 376, in urlopen
[2025-06-30T10:24:00.973+0000] {subprocess.py:93} INFO -     response = conn.urlopen(method, u.request_uri, **kw)
[2025-06-30T10:24:00.973+0000] {subprocess.py:93} INFO -                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.974+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 827, in urlopen
[2025-06-30T10:24:00.974+0000] {subprocess.py:93} INFO -     return self.urlopen(
[2025-06-30T10:24:00.974+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^
[2025-06-30T10:24:00.974+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen
[2025-06-30T10:24:00.974+0000] {subprocess.py:93} INFO -     retries = retries.increment(
[2025-06-30T10:24:00.974+0000] {subprocess.py:93} INFO -               ^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.974+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
[2025-06-30T10:24:00.974+0000] {subprocess.py:93} INFO -     raise MaxRetryError(_pool, url, error or ResponseError(cause))
[2025-06-30T10:24:00.974+0000] {subprocess.py:93} INFO - urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='clickhouse', port=8123): Max retries exceeded with url: /? (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x76dbf38871d0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))
[2025-06-30T10:24:00.974+0000] {subprocess.py:93} INFO - 
[2025-06-30T10:24:00.974+0000] {subprocess.py:93} INFO - The above exception was the direct cause of the following exception:
[2025-06-30T10:24:00.974+0000] {subprocess.py:93} INFO - 
[2025-06-30T10:24:00.974+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2025-06-30T10:24:00.974+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/adapters/clickhouse/httpclient.py", line 58, in _create_client
[2025-06-30T10:24:00.974+0000] {subprocess.py:93} INFO -     return clickhouse_connect.get_client(
[2025-06-30T10:24:00.974+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.974+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/clickhouse_connect/driver/__init__.py", line 122, in create_client
[2025-06-30T10:24:00.975+0000] {subprocess.py:93} INFO -     return HttpClient(interface, host, port, username, password, database, access_token,
[2025-06-30T10:24:00.975+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.975+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/clickhouse_connect/driver/httpclient.py", line 165, in __init__
[2025-06-30T10:24:00.975+0000] {subprocess.py:93} INFO -     super().__init__(database=database,
[2025-06-30T10:24:00.975+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/clickhouse_connect/driver/client.py", line 70, in __init__
[2025-06-30T10:24:00.975+0000] {subprocess.py:93} INFO -     self._init_common_settings(apply_server_timezone)
[2025-06-30T10:24:00.975+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/clickhouse_connect/driver/client.py", line 75, in _init_common_settings
[2025-06-30T10:24:00.975+0000] {subprocess.py:93} INFO -     tuple(self.command('SELECT version(), timezone()', use_database=False))
[2025-06-30T10:24:00.975+0000] {subprocess.py:93} INFO -           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.975+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/clickhouse_connect/driver/httpclient.py", line 368, in command
[2025-06-30T10:24:00.975+0000] {subprocess.py:93} INFO -     response = self._raw_request(payload, params, headers, method, fields=fields, server_wait=False)
[2025-06-30T10:24:00.975+0000] {subprocess.py:93} INFO -                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.975+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/clickhouse_connect/driver/httpclient.py", line 468, in _raw_request
[2025-06-30T10:24:00.975+0000] {subprocess.py:93} INFO -     raise OperationalError(f'Error {ex} executing HTTP request attempt {attempts}{err_url}') from ex
[2025-06-30T10:24:00.975+0000] {subprocess.py:93} INFO - clickhouse_connect.driver.exceptions.OperationalError: Error HTTPConnectionPool(host='clickhouse', port=8123): Max retries exceeded with url: /? (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x76dbf38871d0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution')) executing HTTP request attempt 1 (http://clickhouse:8123)
[2025-06-30T10:24:00.975+0000] {subprocess.py:93} INFO - 
[2025-06-30T10:24:00.975+0000] {subprocess.py:93} INFO - The above exception was the direct cause of the following exception:
[2025-06-30T10:24:00.976+0000] {subprocess.py:93} INFO - 
[2025-06-30T10:24:00.976+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2025-06-30T10:24:00.976+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/adapters/base/connections.py", line 237, in retry_connection
[2025-06-30T10:24:00.976+0000] {subprocess.py:93} INFO -     connection.handle = connect()
[2025-06-30T10:24:00.976+0000] {subprocess.py:93} INFO -                         ^^^^^^^^^
[2025-06-30T10:24:00.976+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/adapters/clickhouse/connections.py", line 45, in connect
[2025-06-30T10:24:00.976+0000] {subprocess.py:93} INFO -     return get_db_client(credentials)
[2025-06-30T10:24:00.976+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.976+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/adapters/clickhouse/dbclient.py", line 66, in get_db_client
[2025-06-30T10:24:00.976+0000] {subprocess.py:93} INFO -     return ChHttpClient(credentials)
[2025-06-30T10:24:00.976+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.976+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/adapters/clickhouse/dbclient.py", line 88, in __init__
[2025-06-30T10:24:00.976+0000] {subprocess.py:93} INFO -     self._client = self._create_client(credentials)
[2025-06-30T10:24:00.976+0000] {subprocess.py:93} INFO -                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.976+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/adapters/clickhouse/httpclient.py", line 75, in _create_client
[2025-06-30T10:24:00.976+0000] {subprocess.py:93} INFO -     raise ChRetryableException(str(ex)) from ex
[2025-06-30T10:24:00.976+0000] {subprocess.py:93} INFO - dbt.adapters.clickhouse.dbclient.ChRetryableException: Error HTTPConnectionPool(host='clickhouse', port=8123): Max retries exceeded with url: /? (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x76dbf38871d0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution')) executing HTTP request attempt 1 (http://clickhouse:8123)
[2025-06-30T10:24:00.977+0000] {subprocess.py:93} INFO - 
[2025-06-30T10:24:00.977+0000] {subprocess.py:93} INFO - During handling of the above exception, another exception occurred:
[2025-06-30T10:24:00.977+0000] {subprocess.py:93} INFO - 
[2025-06-30T10:24:00.977+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2025-06-30T10:24:00.977+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 161, in wrapper
[2025-06-30T10:24:00.977+0000] {subprocess.py:93} INFO -     result, success = func(*args, **kwargs)
[2025-06-30T10:24:00.977+0000] {subprocess.py:93} INFO -                       ^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.977+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 111, in wrapper
[2025-06-30T10:24:00.977+0000] {subprocess.py:93} INFO -     return func(*args, **kwargs)
[2025-06-30T10:24:00.977+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.977+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 254, in wrapper
[2025-06-30T10:24:00.977+0000] {subprocess.py:93} INFO -     return func(*args, **kwargs)
[2025-06-30T10:24:00.977+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.977+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 285, in wrapper
[2025-06-30T10:24:00.977+0000] {subprocess.py:93} INFO -     return func(*args, **kwargs)
[2025-06-30T10:24:00.977+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.977+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 355, in wrapper
[2025-06-30T10:24:00.978+0000] {subprocess.py:93} INFO -     return func(*args, **kwargs)
[2025-06-30T10:24:00.978+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.978+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 332, in wrapper
[2025-06-30T10:24:00.978+0000] {subprocess.py:93} INFO -     return func(*args, **kwargs)
[2025-06-30T10:24:00.978+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.978+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 372, in wrapper
[2025-06-30T10:24:00.978+0000] {subprocess.py:93} INFO -     return func(*args, **kwargs)
[2025-06-30T10:24:00.978+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.978+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/cli/main.py", line 586, in run
[2025-06-30T10:24:00.978+0000] {subprocess.py:93} INFO -     results = task.run()
[2025-06-30T10:24:00.978+0000] {subprocess.py:93} INFO -               ^^^^^^^^^^
[2025-06-30T10:24:00.978+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/task/runnable.py", line 599, in run
[2025-06-30T10:24:00.978+0000] {subprocess.py:93} INFO -     result = self.execute_with_hooks(selected_uids)
[2025-06-30T10:24:00.978+0000] {subprocess.py:93} INFO -              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.978+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/task/runnable.py", line 532, in execute_with_hooks
[2025-06-30T10:24:00.978+0000] {subprocess.py:93} INFO -     before_run_status = self.before_run(adapter, selected_uids)
[2025-06-30T10:24:00.979+0000] {subprocess.py:93} INFO -                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.979+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/task/run.py", line 1074, in before_run
[2025-06-30T10:24:00.979+0000] {subprocess.py:93} INFO -     self.create_schemas(adapter, required_schemas)
[2025-06-30T10:24:00.979+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/task/runnable.py", line 707, in create_schemas
[2025-06-30T10:24:00.979+0000] {subprocess.py:93} INFO -     existing_schemas_lowered.update(ls_future.result())
[2025-06-30T10:24:00.979+0000] {subprocess.py:93} INFO -                                     ^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.979+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
[2025-06-30T10:24:00.979+0000] {subprocess.py:93} INFO -     return self.__get_result()
[2025-06-30T10:24:00.979+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.979+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
[2025-06-30T10:24:00.979+0000] {subprocess.py:93} INFO -     raise self._exception
[2025-06-30T10:24:00.979+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
[2025-06-30T10:24:00.979+0000] {subprocess.py:93} INFO -     result = self.fn(*self.args, **self.kwargs)
[2025-06-30T10:24:00.979+0000] {subprocess.py:93} INFO -              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.979+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt_common/utils/executor.py", line 16, in connected
[2025-06-30T10:24:00.979+0000] {subprocess.py:93} INFO -     return func(*args, **kwargs)
[2025-06-30T10:24:00.979+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.980+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/task/runnable.py", line 682, in list_schemas
[2025-06-30T10:24:00.980+0000] {subprocess.py:93} INFO -     for s in adapter.list_schemas(database_quoted)
[2025-06-30T10:24:00.980+0000] {subprocess.py:93} INFO -              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.980+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/adapters/sql/impl.py", line 215, in list_schemas
[2025-06-30T10:24:00.980+0000] {subprocess.py:93} INFO -     results = self.execute_macro(LIST_SCHEMAS_MACRO_NAME, kwargs={"database": database})
[2025-06-30T10:24:00.980+0000] {subprocess.py:93} INFO -               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.980+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1275, in execute_macro
[2025-06-30T10:24:00.980+0000] {subprocess.py:93} INFO -     result = macro_function(**kwargs)
[2025-06-30T10:24:00.980+0000] {subprocess.py:93} INFO -              ^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.980+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 427, in __call__
[2025-06-30T10:24:00.980+0000] {subprocess.py:93} INFO -     return self.call_macro(*args, **kwargs)
[2025-06-30T10:24:00.980+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.980+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
[2025-06-30T10:24:00.980+0000] {subprocess.py:93} INFO -     return macro(*args, **kwargs)
[2025-06-30T10:24:00.980+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.980+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
[2025-06-30T10:24:00.980+0000] {subprocess.py:93} INFO -     return self._invoke(arguments, autoescape)
[2025-06-30T10:24:00.981+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.981+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
[2025-06-30T10:24:00.981+0000] {subprocess.py:93} INFO -     rv = self._func(*arguments)
[2025-06-30T10:24:00.981+0000] {subprocess.py:93} INFO -          ^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.981+0000] {subprocess.py:93} INFO -   File "<template>", line 20, in macro
[2025-06-30T10:24:00.981+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
[2025-06-30T10:24:00.981+0000] {subprocess.py:93} INFO -     return __context.call(__obj, *args, **kwargs)
[2025-06-30T10:24:00.981+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.981+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
[2025-06-30T10:24:00.981+0000] {subprocess.py:93} INFO -     return __obj(*args, **kwargs)
[2025-06-30T10:24:00.981+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.981+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 82, in __call__
[2025-06-30T10:24:00.981+0000] {subprocess.py:93} INFO -     return self.call_macro(*args, **kwargs)
[2025-06-30T10:24:00.981+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.981+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
[2025-06-30T10:24:00.981+0000] {subprocess.py:93} INFO -     return macro(*args, **kwargs)
[2025-06-30T10:24:00.982+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.982+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
[2025-06-30T10:24:00.982+0000] {subprocess.py:93} INFO -     return self._invoke(arguments, autoescape)
[2025-06-30T10:24:00.982+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.982+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
[2025-06-30T10:24:00.982+0000] {subprocess.py:93} INFO -     rv = self._func(*arguments)
[2025-06-30T10:24:00.982+0000] {subprocess.py:93} INFO -          ^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.982+0000] {subprocess.py:93} INFO -   File "<template>", line 31, in macro
[2025-06-30T10:24:00.982+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
[2025-06-30T10:24:00.982+0000] {subprocess.py:93} INFO -     return __context.call(__obj, *args, **kwargs)
[2025-06-30T10:24:00.982+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.982+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
[2025-06-30T10:24:00.982+0000] {subprocess.py:93} INFO -     return __obj(*args, **kwargs)
[2025-06-30T10:24:00.982+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.982+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 82, in __call__
[2025-06-30T10:24:00.982+0000] {subprocess.py:93} INFO -     return self.call_macro(*args, **kwargs)
[2025-06-30T10:24:00.983+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.983+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
[2025-06-30T10:24:00.983+0000] {subprocess.py:93} INFO -     return macro(*args, **kwargs)
[2025-06-30T10:24:00.983+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.983+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
[2025-06-30T10:24:00.983+0000] {subprocess.py:93} INFO -     return self._invoke(arguments, autoescape)
[2025-06-30T10:24:00.983+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.983+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
[2025-06-30T10:24:00.983+0000] {subprocess.py:93} INFO -     rv = self._func(*arguments)
[2025-06-30T10:24:00.983+0000] {subprocess.py:93} INFO -          ^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.983+0000] {subprocess.py:93} INFO -   File "<template>", line 52, in macro
[2025-06-30T10:24:00.983+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
[2025-06-30T10:24:00.983+0000] {subprocess.py:93} INFO -     return __context.call(__obj, *args, **kwargs)
[2025-06-30T10:24:00.983+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.983+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
[2025-06-30T10:24:00.983+0000] {subprocess.py:93} INFO -     return __obj(*args, **kwargs)
[2025-06-30T10:24:00.983+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.983+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt_common/record.py", line 507, in record_replay_wrapper
[2025-06-30T10:24:00.984+0000] {subprocess.py:93} INFO -     return func_to_record(*call_args, **kwargs)
[2025-06-30T10:24:00.984+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.984+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 437, in execute
[2025-06-30T10:24:00.984+0000] {subprocess.py:93} INFO -     return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
[2025-06-30T10:24:00.984+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.984+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/adapters/clickhouse/connections.py", line 88, in execute
[2025-06-30T10:24:00.984+0000] {subprocess.py:93} INFO -     client = conn.handle
[2025-06-30T10:24:00.984+0000] {subprocess.py:93} INFO -              ^^^^^^^^^^^
[2025-06-30T10:24:00.984+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/adapters/contracts/connection.py", line 96, in handle
[2025-06-30T10:24:00.984+0000] {subprocess.py:93} INFO -     self._handle.resolve(self)
[2025-06-30T10:24:00.984+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/adapters/contracts/connection.py", line 120, in resolve
[2025-06-30T10:24:00.984+0000] {subprocess.py:93} INFO -     return self.opener(connection)
[2025-06-30T10:24:00.984+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.984+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/adapters/clickhouse/connections.py", line 47, in open
[2025-06-30T10:24:00.984+0000] {subprocess.py:93} INFO -     return cls.retry_connection(
[2025-06-30T10:24:00.984+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.984+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/adapters/base/connections.py", line 254, in retry_connection
[2025-06-30T10:24:00.985+0000] {subprocess.py:93} INFO -     return cls.retry_connection(
[2025-06-30T10:24:00.985+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.985+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/adapters/base/connections.py", line 245, in retry_connection
[2025-06-30T10:24:00.985+0000] {subprocess.py:93} INFO -     raise FailedToConnectError(str(e))
[2025-06-30T10:24:00.985+0000] {subprocess.py:93} INFO - dbt.adapters.exceptions.connection.FailedToConnectError: Database Error
[2025-06-30T10:24:00.985+0000] {subprocess.py:93} INFO -   Error HTTPConnectionPool(host='clickhouse', port=8123): Max retries exceeded with url: /? (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x76dbf38871d0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution')) executing HTTP request attempt 1 (http://clickhouse:8123)
[2025-06-30T10:24:00.985+0000] {subprocess.py:93} INFO - 
[2025-06-30T10:24:00.985+0000] {subprocess.py:93} INFO - During handling of the above exception, another exception occurred:
[2025-06-30T10:24:00.985+0000] {subprocess.py:93} INFO - 
[2025-06-30T10:24:00.985+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2025-06-30T10:24:00.985+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 167, in wrapper
[2025-06-30T10:24:00.985+0000] {subprocess.py:93} INFO -     raise ExceptionExit(e)
[2025-06-30T10:24:00.985+0000] {subprocess.py:93} INFO - dbt.cli.exceptions.ExceptionExit: <exception str() failed>
[2025-06-30T10:24:00.985+0000] {subprocess.py:93} INFO - 
[2025-06-30T10:24:00.985+0000] {subprocess.py:93} INFO - During handling of the above exception, another exception occurred:
[2025-06-30T10:24:00.985+0000] {subprocess.py:93} INFO - 
[2025-06-30T10:24:00.985+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2025-06-30T10:24:00.986+0000] {subprocess.py:93} INFO -   File "/home/***/.local/bin/dbt", line 8, in <module>
[2025-06-30T10:24:00.986+0000] {subprocess.py:93} INFO -     sys.exit(cli())
[2025-06-30T10:24:00.986+0000] {subprocess.py:93} INFO -              ^^^^^
[2025-06-30T10:24:00.986+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
[2025-06-30T10:24:00.986+0000] {subprocess.py:93} INFO -     return self.main(*args, **kwargs)
[2025-06-30T10:24:00.986+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.986+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/click/core.py", line 1078, in main
[2025-06-30T10:24:00.986+0000] {subprocess.py:93} INFO -     rv = self.invoke(ctx)
[2025-06-30T10:24:00.986+0000] {subprocess.py:93} INFO -          ^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.986+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
[2025-06-30T10:24:00.986+0000] {subprocess.py:93} INFO -     return _process_result(sub_ctx.command.invoke(sub_ctx))
[2025-06-30T10:24:00.986+0000] {subprocess.py:93} INFO -                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.986+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
[2025-06-30T10:24:00.986+0000] {subprocess.py:93} INFO -     return ctx.invoke(self.callback, **ctx.params)
[2025-06-30T10:24:00.986+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.986+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
[2025-06-30T10:24:00.986+0000] {subprocess.py:93} INFO -     return __callback(*args, **kwargs)
[2025-06-30T10:24:00.986+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.987+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
[2025-06-30T10:24:00.987+0000] {subprocess.py:93} INFO -     return f(get_current_context(), *args, **kwargs)
[2025-06-30T10:24:00.987+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.987+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/cli/main.py", line 149, in wrapper
[2025-06-30T10:24:00.987+0000] {subprocess.py:93} INFO -     return func(*args, **kwargs)
[2025-06-30T10:24:00.987+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.987+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 190, in wrapper
[2025-06-30T10:24:00.987+0000] {subprocess.py:93} INFO -     fire_event(
[2025-06-30T10:24:00.987+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt_common/events/functions.py", line 142, in fire_event
[2025-06-30T10:24:00.987+0000] {subprocess.py:93} INFO -     get_event_manager().fire_event(
[2025-06-30T10:24:00.987+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt_common/events/event_manager.py", line 56, in fire_event
[2025-06-30T10:24:00.987+0000] {subprocess.py:93} INFO -     msg = msg_from_base_event(e, level=level)
[2025-06-30T10:24:00.987+0000] {subprocess.py:93} INFO -           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.987+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt_common/events/base_types.py", line 140, in msg_from_base_event
[2025-06-30T10:24:00.987+0000] {subprocess.py:93} INFO -     "msg": event.message(),
[2025-06-30T10:24:00.987+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^
[2025-06-30T10:24:00.987+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt/events/types.py", line 2400, in message
[2025-06-30T10:24:00.988+0000] {subprocess.py:93} INFO -     return f"Resource report: {self.to_json()}"
[2025-06-30T10:24:00.988+0000] {subprocess.py:93} INFO -                                ^^^^^^^^^^^^^^
[2025-06-30T10:24:00.988+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.11/site-packages/dbt_common/events/base_types.py", line 98, in to_json
[2025-06-30T10:24:00.988+0000] {subprocess.py:93} INFO -     return MessageToJson(
[2025-06-30T10:24:00.988+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^
[2025-06-30T10:24:00.988+0000] {subprocess.py:93} INFO - TypeError: MessageToJson() got an unexpected keyword argument 'always_print_fields_with_no_presence'
[2025-06-30T10:24:01.378+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2025-06-30T10:24:01.379+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-06-30T10:24:01.387+0000] {taskinstance.py:2890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/operators/bash.py", line 243, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2025-06-30T10:24:01.389+0000] {taskinstance.py:1205} INFO - Marking task as UP_FOR_RETRY. dag_id=dbt_run_checkout_pipeline, task_id=auto_run_dbt, execution_date=20250630T091013, start_date=20250630T102354, end_date=20250630T102401
[2025-06-30T10:24:01.404+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 54 for task auto_run_dbt (Bash command failed. The command returned a non-zero exit code 1.; 1122)
[2025-06-30T10:24:01.436+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2025-06-30T10:24:01.446+0000] {taskinstance.py:3482} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-06-30T10:24:01.447+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
